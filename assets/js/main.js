//проверка на пробелы
function space(str){return str.trim()!="";}let allList=document.querySelector('ul');let allDoneList=document.querySelector('ul.done__list');//сохранение задач
function saveLocal(){let allTasks;let allTDone;if(allList.innerHTML){allTasks=allList.innerHTML;localStorage.setItem('allTasks',allTasks);}if(allDoneList.innerHTML){allDone=allDoneList.innerHTML;localStorage.setItem('allDone',allDone);}}if(localStorage.getItem('allTasks')){allList.innerHTML=localStorage.getItem('allTasks');}if(localStorage.getItem('allDone')){allDoneList.innerHTML=localStorage.getItem('allDone');}//очистить все списки
window.onkeydown=function(event){if(event.ctrlKey&&event.code==='KeyD'){event.preventDefault();localStorage.clear();window.location.reload();}};//создание новой задачи
const taskInput=document.getElementById('taskInput');function createTask(){const tasksList=document.getElementById('tasksList');const taskText=taskInput.value;console.log(taskText);if(space(taskText)){const newLi=document.createElement('li');newLi.classList.add('tasks__item');newLi.insertAdjacentHTML(`beforeend`,`<div class="tasks__box"></div>`);const textSpan=document.createElement('span');textSpan.classList.add('tasks__text');textSpan.innerText=taskText;newLi.append(textSpan);newLi.insertAdjacentHTML(`beforeend`,`
            <div class="tasks__edit"><img src="./assets/img/pen30.png" alt="Edit"></div>
            <div class="tasks__update"><img src="./assets/img/flag30.png" alt="Update"></div>
            <div class="tasks__del"><img src="./assets/img/trash30.png" alt="Delete"></div>`);tasksList.append(newLi);taskInput.value="";}else{alert('Enter task!');}saveLocal();}taskInput.onkeypress=function(e){if(e.key==='Enter'){createTask();}};taskInput.addEventListener('keyup',function(e){if(e.key==='Escape'){this.value="";}});addEventListener('click',function(e){//добавление новой задачи кнопкой
if(e.target.closest('#addBtn')){createTask();}//отметить елемент чекбокс
if(e.target.closest('.tasks__box')){e.target.closest('.tasks__box').classList.toggle('checked');}// отметить/убрать отметки со всех задач
const boxes=document.querySelectorAll('.tasks__box');if(e.target.closest('.controls__check-button')){if(boxes[0].classList.contains('checked')){for(let tList of boxes){tList.classList.remove('checked');}}else{for(let tList of boxes){tList.classList.add('checked');}}}//удалить задачу кнопкой
if(e.target.closest('.tasks__del')){e.target.closest('.tasks__item').remove();}//удалить все отмеченные задачи
if(e.target.closest('.controls__del-button')){for(let list of boxes){if(list.classList.contains('checked')){list.parentElement.remove();}}}// редактировать задачу
if(e.target.closest('.tasks__edit')){const editBtn=e.target.closest('.tasks__edit');let taskElement=editBtn.previousElementSibling;const editInput=document.createElement('input');editInput.classList.add('tasks__edit-input');editInput.classList.add('task-input');editInput.type='text';editBtn.previousElementSibling.outerHTML=editInput.outerHTML;editBtn.previousElementSibling.value=taskElement.innerHTML;editBtn.previousElementSibling.placeholder='Enter task';editBtn.classList.toggle('active');editBtn.nextElementSibling.classList.toggle('active');editBtn.previousElementSibling.focus();}// нажатие кнопки update
if(e.target.closest('.tasks__update')){updateTask(e.target.closest('.tasks__update').previousElementSibling.previousElementSibling);}saveLocal();});addEventListener('keypress',function(e){console.log(e.target);if(e.target.classList.contains('tasks__edit-input')&&e.key==='Enter'){updateTask(e.target);}});//сохранение изменений задачи
function updateTask(targets){const newTaskValue=targets.value;if(space(newTaskValue)){const newTask=document.createElement('span');targets.nextElementSibling.classList.toggle('active');targets.nextElementSibling.nextElementSibling.classList.toggle('active');newTask.classList.add('tasks__text');newTask.innerText=newTaskValue;targets.outerHTML=newTask.outerHTML;}else{return alert('Enter task');}saveLocal();}//перенести отмеченные задачи в выполненый список
const doneBtn=document.querySelector('.controls__done-button');doneBtn.onclick=function(){const tasksLi=document.querySelectorAll('.tasks__item');let newDoneList=Array.from(tasksLi).filter(function(item,index,array){return item.firstElementChild.classList.contains('checked');});console.log(newDoneList);let doneList=document.getElementById('doneList');for(let d of newDoneList){let node=document.createElement('li');node.className='done__item';node.appendChild(document.createElement('span'));if(d.children[1].tagName==='INPUT'){node.firstElementChild.innerHTML=d.children[1].value;}else{node.firstElementChild.innerHTML=d.children[1].innerHTML;}doneList.prepend(node);d.remove();}saveLocal();};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsic3BhY2UiLCJzdHIiLCJ0cmltIiwiYWxsTGlzdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFsbERvbmVMaXN0Iiwic2F2ZUxvY2FsIiwiYWxsVGFza3MiLCJhbGxURG9uZSIsImlubmVySFRNTCIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJhbGxEb25lIiwiZ2V0SXRlbSIsIndpbmRvdyIsIm9ua2V5ZG93biIsImV2ZW50IiwiY3RybEtleSIsImNvZGUiLCJwcmV2ZW50RGVmYXVsdCIsImNsZWFyIiwibG9jYXRpb24iLCJyZWxvYWQiLCJ0YXNrSW5wdXQiLCJnZXRFbGVtZW50QnlJZCIsImNyZWF0ZVRhc2siLCJ0YXNrc0xpc3QiLCJ0YXNrVGV4dCIsInZhbHVlIiwiY29uc29sZSIsImxvZyIsIm5ld0xpIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsImluc2VydEFkamFjZW50SFRNTCIsInRleHRTcGFuIiwiaW5uZXJUZXh0IiwiYXBwZW5kIiwiYWxlcnQiLCJvbmtleXByZXNzIiwiZSIsImtleSIsImFkZEV2ZW50TGlzdGVuZXIiLCJ0YXJnZXQiLCJjbG9zZXN0IiwidG9nZ2xlIiwiYm94ZXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiY29udGFpbnMiLCJ0TGlzdCIsInJlbW92ZSIsImxpc3QiLCJwYXJlbnRFbGVtZW50IiwiZWRpdEJ0biIsInRhc2tFbGVtZW50IiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImVkaXRJbnB1dCIsInR5cGUiLCJvdXRlckhUTUwiLCJwbGFjZWhvbGRlciIsIm5leHRFbGVtZW50U2libGluZyIsImZvY3VzIiwidXBkYXRlVGFzayIsInRhcmdldHMiLCJuZXdUYXNrVmFsdWUiLCJuZXdUYXNrIiwiZG9uZUJ0biIsIm9uY2xpY2siLCJ0YXNrc0xpIiwibmV3RG9uZUxpc3QiLCJBcnJheSIsImZyb20iLCJmaWx0ZXIiLCJpdGVtIiwiaW5kZXgiLCJhcnJheSIsImZpcnN0RWxlbWVudENoaWxkIiwiZG9uZUxpc3QiLCJkIiwibm9kZSIsImNsYXNzTmFtZSIsImFwcGVuZENoaWxkIiwiY2hpbGRyZW4iLCJ0YWdOYW1lIiwicHJlcGVuZCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQSxRQUFTQSxDQUFBQSxLQUFULENBQWdCQyxHQUFoQixDQUFxQixDQUNuQixNQUFPQSxDQUFBQSxHQUFHLENBQUNDLElBQUosSUFBYyxFQUFyQixDQUNELENBRUQsR0FBSUMsQ0FBQUEsT0FBTyxDQUFHQyxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsSUFBdkIsQ0FBZCxDQUNBLEdBQUlDLENBQUFBLFdBQVcsQ0FBR0YsUUFBUSxDQUFDQyxhQUFULENBQXVCLGVBQXZCLENBQWxCLENBQ0E7QUFDQSxRQUFTRSxDQUFBQSxTQUFULEVBQXNCLENBQ3BCLEdBQUlDLENBQUFBLFFBQUosQ0FDQSxHQUFJQyxDQUFBQSxRQUFKLENBQ0EsR0FBSU4sT0FBTyxDQUFDTyxTQUFaLENBQXVCLENBQ3JCRixRQUFRLENBQUdMLE9BQU8sQ0FBQ08sU0FBbkIsQ0FDQUMsWUFBWSxDQUFDQyxPQUFiLENBQXFCLFVBQXJCLENBQWlDSixRQUFqQyxFQUNELENBQ0QsR0FBSUYsV0FBVyxDQUFDSSxTQUFoQixDQUEyQixDQUN6QkcsT0FBTyxDQUFHUCxXQUFXLENBQUNJLFNBQXRCLENBQ0FDLFlBQVksQ0FBQ0MsT0FBYixDQUFxQixTQUFyQixDQUFnQ0MsT0FBaEMsRUFDRCxDQUNGLENBRUQsR0FBSUYsWUFBWSxDQUFDRyxPQUFiLENBQXFCLFVBQXJCLENBQUosQ0FBc0MsQ0FDcENYLE9BQU8sQ0FBQ08sU0FBUixDQUFvQkMsWUFBWSxDQUFDRyxPQUFiLENBQXFCLFVBQXJCLENBQXBCLENBQ0QsQ0FDRCxHQUFJSCxZQUFZLENBQUNHLE9BQWIsQ0FBcUIsU0FBckIsQ0FBSixDQUFxQyxDQUNuQ1IsV0FBVyxDQUFDSSxTQUFaLENBQXdCQyxZQUFZLENBQUNHLE9BQWIsQ0FBcUIsU0FBckIsQ0FBeEIsQ0FDRCxDQUVEO0FB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LFdBQVosRUFDQSxHQUFJUSxDQUFBQSxRQUFRLENBQUczRSxRQUFRLENBQUNxQixjQUFULENBQXdCLFVBQXhCLENBQWYsQ0FDQSxJQUFLLEdBQUl1RCxDQUFBQSxDQUFULEdBQWNULENBQUFBLFdBQWQsQ0FBMkIsQ0FDekIsR0FBSVUsQ0FBQUEsSUFBSSxDQUFHN0UsUUFBUSxDQUFDNkIsYUFBVCxDQUF1QixJQUF2QixDQUFYLENBQ0FnRCxJQUFJLENBQUNDLFNBQUwsQ0FBaUIsWUFBakIsQ0FDQUQsSUFBSSxDQUFDRSxXQUFMLENBQWlCL0UsUUFBUSxDQUFDNkIsYUFBVCxDQUF1QixNQUF2QixDQUFqQixFQUNBLEdBQUkrQyxDQUFDLENBQUNJLFFBQUYsQ0FBVyxDQUFYLEVBQWNDLE9BQWQsR0FBMEIsT0FBOUIsQ0FBdUMsQ0FDckNKLElBQUksQ0FBQ0gsaUJBQUwsQ0FBdUJwRSxTQUF2QixDQUFtQ3NFLENBQUMsQ0FBQ0ksUUFBRixDQUFXLENBQVgsRUFBY3ZELEtBQWpELENBQ0QsQ0FGRCxJQUVPLENBQ0xvRCxJQUFJLENBQUNILGlCQUFMLENBQXVCcEUsU0FBdkIsQ0FBbUNzRSxDQUFDLENBQUNJLFFBQUYsQ0FBVyxDQUFYLEVBQWMxRSxTQUFqRCxDQUNELENBQ0RxRSxRQUFRLENBQUNPLE9BQVQsQ0FBaUJMLElBQWpCLEVBQ0FELENBQUMsQ0FBQzVCLE1BQUYsR0FDRCxDQUNEN0MsU0FBUyxHQUNWLENBcEJEIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL9C/0YDQvtCy0LXRgNC60LAg0L3QsCDQv9GA0L7QsdC10LvRi1xyXG5mdW5jdGlvbiBzcGFjZSAoc3RyKSB7XHJcbiAgcmV0dXJuIHN0ci50cmltKCkgIT0gXCJcIjtcclxufVxyXG5cclxubGV0IGFsbExpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpO1xyXG5sZXQgYWxsRG9uZUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bC5kb25lX19saXN0Jyk7XHJcbi8v0YHQvtGF0YDQsNC90LXQvdC40LUg0LfQsNC00LDRh1xyXG5mdW5jdGlvbiBzYXZlTG9jYWwgKCkge1xyXG4gIGxldCBhbGxUYXNrcztcclxuICBsZXQgYWxsVERvbmU7XHJcbiAgaWYgKGFsbExpc3QuaW5uZXJIVE1MKSB7XHJcbiAgICBhbGxUYXNrcyA9IGFsbExpc3QuaW5uZXJIVE1MO1xyXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2FsbFRhc2tzJywgYWxsVGFza3MpXHJcbiAgfVxyXG4gIGlmIChhbGxEb25lTGlzdC5pbm5lckhUTUwpIHtcclxuICAgIGFsbERvbmUgPSBhbGxEb25lTGlzdC5pbm5lckhUTUw7XHJcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWxsRG9uZScsIGFsbERvbmUpXHJcbiAgfVxyXG59XHJcblxyXG5pZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FsbFRhc2tzJykpIHtcclxuICBhbGxMaXN0LmlubmVySFRNTCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhbGxUYXNrcycpXHJcbn1cclxuaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhbGxEb25lJykpIHtcclxuICBhbGxEb25lTGlzdC5pbm5lckhUTUwgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWxsRG9uZScpXHJcbn1cclxuXHJcbi8v0L7Rh9C40YHRgtC40YLRjCDQstGB0LUg0YHQv9C40YHQutC4XHJcbndpbmRvdy5vbmtleWRvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICBpZiAoZXZlbnQuY3RybEtleSAmJiBldmVudC5jb2RlID09PSAnS2V5RCcpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKVxyXG4gICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG4gIH1cclxufVxyXG4vL9GB0L7Qt9C00LDQvdC40LUg0L3QvtCy0L7QuSDQt9Cw0LTQsNGH0LhcclxuY29uc3QgdGFza0lucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Rhc2tJbnB1dCcpO1xyXG5mdW5jdGlvbiBjcmVhdGVUYXNrICgpIHtcclxuICBjb25zdCB0YXNrc0xpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGFza3NMaXN0Jyk7XHJcbiAgY29uc3QgdGFza1RleHQgPSB0YXNrSW5wdXQudmFsdWU7XHJcbiAgY29uc29sZS5sb2codGFza1RleHQpXHJcbiAgaWYgKHNwYWNlKHRhc2tUZXh0KSkgIHtcclxuICAgIGNvbnN0IG5ld0xpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgIG5ld0xpLmNsYXNzTGlzdC5hZGQoJ3Rhc2tzX19pdGVtJyk7XHJcbiAgICBuZXdMaS5pbnNlcnRBZGphY2VudEhUTUwoYGJlZm9yZWVuZGAsXHJcbiAgICAgIGA8ZGl2IGNsYXNzPVwidGFza3NfX2JveFwiPjwvZGl2PmApXHJcbiAgICBjb25zdCB0ZXh0U3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgIHRleHRTcGFuLmNsYXNzTGlzdC5hZGQoJ3Rhc2tzX190ZXh0Jyk7XHJcbiAgICB0ZXh0U3Bhbi5pbm5lclRleHQgPSB0YXNrVGV4dDtcclxuICAgIG5ld0xpLmFwcGVuZCh0ZXh0U3Bhbik7XHJcbiAgICBuZXdMaS5pbnNlcnRBZGphY2VudEhUTUwoYGJlZm9yZWVuZGAsXHJcbiAgICAgIGBcclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhc2tzX19lZGl0XCI+PGltZyBzcmM9XCIuL2Fzc2V0cy9pbWcvcGVuMzAucG5nXCIgYWx0PVwiRWRpdFwiPjwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwidGFza3NfX3VwZGF0ZVwiPjxpbWcgc3JjPVwiLi9hc3NldHMvaW1nL2ZsYWczMC5wbmdcIiBhbHQ9XCJVcGRhdGVcIj48L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cInRhc2tzX19kZWxcIj48aW1nIHNyYz1cIi4vYXNzZXRzL2ltZy90cmFzaDMwLnBuZ1wiIGFsdD1cIkRlbGV0ZVwiPjwvZGl2PmApXHJcbiAgICB0YXNrc0xpc3QuYXBwZW5kKG5ld0xpKTtcclxuICAgIHRhc2tJbnB1dC52YWx1ZSA9IFwiXCI7XHJcbiAgfVxyXG4gIGVsc2Uge1xyXG4gICAgYWxlcnQoJ0VudGVyIHRhc2shJyk7XHJcbiAgfVxyXG4gIHNhdmVMb2NhbCgpO1xyXG59XHJcblxyXG5cclxudGFza0lucHV0Lm9ua2V5cHJlc3MgPSBmdW5jdGlvbiAoZSkge1xyXG4gIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xyXG4gICAgY3JlYXRlVGFzaygpO1xyXG4gIH1cclxufVxyXG5cclxudGFza0lucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZnVuY3Rpb24gKGUpe1xyXG4gIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgIHRoaXMudmFsdWUgPSBcIlwiO1xyXG4gIH1cclxufSlcclxuXHJcbmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAvL9C00L7QsdCw0LLQu9C10L3QuNC1INC90L7QstC+0Lkg0LfQsNC00LDRh9C4INC60L3QvtC/0LrQvtC5XHJcbiAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJyNhZGRCdG4nKSkge1xyXG4gICAgY3JlYXRlVGFzaygpO1xyXG4gIH1cclxuICAgIC8v0L7RgtC80LXRgtC40YLRjCDQtdC70LXQvNC10L3RgiDRh9C10LrQsdC+0LrRgVxyXG4gIGlmIChlLnRhcmdldC5jbG9zZXN0KCcudGFza3NfX2JveCcpKSB7XHJcbiAgICBlLnRhcmdldC5jbG9zZXN0KCcudGFza3NfX2JveCcpLmNsYXNzTGlzdC50b2dnbGUoJ2NoZWNrZWQnKTtcclxuICB9XHJcbiAvLyDQvtGC0LzQtdGC0LjRgtGML9GD0LHRgNCw0YLRjCDQvtGC0LzQtdGC0LrQuCDRgdC+INCy0YHQtdGFINC30LDQtNCw0YdcclxuICBjb25zdCBib3hlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YXNrc19fYm94Jyk7XHJcbiAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy5jb250cm9sc19fY2hlY2stYnV0dG9uJykpIHtcclxuICAgIGlmIChib3hlc1swXS5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xyXG4gICAgICBmb3IgKGxldCB0TGlzdCBvZiBib3hlcykge1xyXG4gICAgICAgIHRMaXN0LmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZm9yIChsZXQgdExpc3Qgb2YgYm94ZXMpIHtcclxuICAgICAgICB0TGlzdC5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgICAvL9GD0LTQsNC70LjRgtGMINC30LDQtNCw0YfRgyDQutC90L7Qv9C60L7QuVxyXG4gIGlmIChlLnRhcmdldC5jbG9zZXN0KCcudGFza3NfX2RlbCcpKSB7XHJcbiAgICBlLnRhcmdldC5jbG9zZXN0KCcudGFza3NfX2l0ZW0nKS5yZW1vdmUoKTtcclxuICB9XHJcbiAgICAvL9GD0LTQsNC70LjRgtGMINCy0YHQtSDQvtGC0LzQtdGH0LXQvdC90YvQtSDQt9Cw0LTQsNGH0LhcclxuICBpZiAoZS50YXJnZXQuY2xvc2VzdCgnLmNvbnRyb2xzX19kZWwtYnV0dG9uJykpIHtcclxuICAgIGZvciAobGV0IGxpc3Qgb2YgYm94ZXMpIHtcclxuICAgICAgaWYgKGxpc3QuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2VkJykpIHtcclxuICAgICAgICBsaXN0LnBhcmVudEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgLy8g0YDQtdC00LDQutGC0LjRgNC+0LLQsNGC0Ywg0LfQsNC00LDRh9GDXHJcbiAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy50YXNrc19fZWRpdCcpKSB7XHJcbiAgICBjb25zdCBlZGl0QnRuID0gZS50YXJnZXQuY2xvc2VzdCgnLnRhc2tzX19lZGl0Jyk7XHJcbiAgICBsZXQgdGFza0VsZW1lbnQgPSBlZGl0QnRuLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XHJcbiAgICBjb25zdCBlZGl0SW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgZWRpdElucHV0LmNsYXNzTGlzdC5hZGQoJ3Rhc2tzX19lZGl0LWlucHV0Jyk7XHJcbiAgICBlZGl0SW5wdXQuY2xhc3NMaXN0LmFkZCgndGFzay1pbnB1dCcpO1xyXG4gICAgZWRpdElucHV0LnR5cGUgPSAndGV4dCc7XHJcbiAgICBlZGl0QnRuLnByZXZpb3VzRWxlbWVudFNpYmxpbmcub3V0ZXJIVE1MID0gZWRpdElucHV0Lm91dGVySFRNTDtcclxuICAgIGVkaXRCdG4ucHJldmlvdXNFbGVtZW50U2libGluZy52YWx1ZSA9IHRhc2tFbGVtZW50LmlubmVySFRNTDtcclxuICAgIGVkaXRCdG4ucHJldmlvdXNFbGVtZW50U2libGluZy5wbGFjZWhvbGRlciA9ICdFbnRlciB0YXNrJztcclxuICAgIGVkaXRCdG4uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XHJcbiAgICBlZGl0QnRuLm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcclxuICAgIGVkaXRCdG4ucHJldmlvdXNFbGVtZW50U2libGluZy5mb2N1cygpO1xyXG4gIH1cclxuICAvLyDQvdCw0LbQsNGC0LjQtSDQutC90L7Qv9C60LggdXBkYXRlXHJcbiAgaWYgKGUudGFyZ2V0LmNsb3Nlc3QoJy50YXNrc19fdXBkYXRlJykpIHtcclxuICAgIHVwZGF0ZVRhc2soZS50YXJnZXQuY2xvc2VzdCgnLnRhc2tzX191cGRhdGUnKS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpXHJcbiAgfVxyXG4gIHNhdmVMb2NhbCgpO1xyXG59KVxyXG5cclxuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCBmdW5jdGlvbiAoZSkge1xyXG4gIGNvbnNvbGUubG9nKGUudGFyZ2V0KVxyXG4gIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3Rhc2tzX19lZGl0LWlucHV0JykgICYmIGUua2V5ID09PSAnRW50ZXInKSB7XHJcbiAgICB1cGRhdGVUYXNrKGUudGFyZ2V0KVxyXG4gIH1cclxufSlcclxuXHJcbiAvL9GB0L7RhdGA0LDQvdC10L3QuNC1INC40LfQvNC10L3QtdC90LjQuSDQt9Cw0LTQsNGH0LhcclxuZnVuY3Rpb24gdXBkYXRlVGFzayAodGFyZ2V0cykge1xyXG4gIGNvbnN0IG5ld1Rhc2tWYWx1ZSA9IHRhcmdldHMudmFsdWU7XHJcbiAgaWYgKHNwYWNlKG5ld1Rhc2tWYWx1ZSkpIHtcclxuICAgIGNvbnN0IG5ld1Rhc2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICB0YXJnZXRzLm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcclxuICAgIHRhcmdldHMubmV4dEVsZW1lbnRTaWJsaW5nLm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTtcclxuICAgIG5ld1Rhc2suY2xhc3NMaXN0LmFkZCgndGFza3NfX3RleHQnKTtcclxuICAgIG5ld1Rhc2suaW5uZXJUZXh0ID0gbmV3VGFza1ZhbHVlO1xyXG4gICAgdGFyZ2V0cy5vdXRlckhUTUwgPSBuZXdUYXNrLm91dGVySFRNTDtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIGFsZXJ0KCdFbnRlciB0YXNrJyk7XHJcbiAgfVxyXG4gIHNhdmVMb2NhbCgpO1xyXG59XHJcblxyXG4vL9C/0LXRgNC10L3QtdGB0YLQuCDQvtGC0LzQtdGH0LXQvdC90YvQtSDQt9Cw0LTQsNGH0Lgg0LIg0LLRi9C/0L7Qu9C90LXQvdGL0Lkg0YHQv9C40YHQvtC6XHJcbmNvbnN0IGRvbmVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJvbHNfX2RvbmUtYnV0dG9uJyk7XHJcbmRvbmVCdG4ub25jbGljayA9IGZ1bmN0aW9uKCkge1xyXG4gIGNvbnN0IHRhc2tzTGkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcudGFza3NfX2l0ZW0nKTtcclxuICBsZXQgbmV3RG9uZUxpc3QgPSBBcnJheS5mcm9tKHRhc2tzTGkpLmZpbHRlcihmdW5jdGlvbiAoaXRlbSwgaW5kZXgsIGFycmF5KSB7XHJcbiAgICByZXR1cm4gaXRlbS5maXJzdEVsZW1lbnRDaGlsZC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKTtcclxuICB9KVxyXG4gIGNvbnNvbGUubG9nKG5ld0RvbmVMaXN0KVxyXG4gIGxldCBkb25lTGlzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkb25lTGlzdCcpO1xyXG4gIGZvciAobGV0IGQgb2YgbmV3RG9uZUxpc3QpIHtcclxuICAgIGxldCBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICAgIG5vZGUuY2xhc3NOYW1lID0gJ2RvbmVfX2l0ZW0nO1xyXG4gICAgbm9kZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJykpO1xyXG4gICAgaWYgKGQuY2hpbGRyZW5bMV0udGFnTmFtZSA9PT0gJ0lOUFVUJykge1xyXG4gICAgICBub2RlLmZpcnN0RWxlbWVudENoaWxkLmlubmVySFRNTCA9IGQuY2hpbGRyZW5bMV0udmFsdWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBub2RlLmZpcnN0RWxlbWVudENoaWxkLmlubmVySFRNTCA9IGQuY2hpbGRyZW5bMV0uaW5uZXJIVE1MO1xyXG4gICAgfVxyXG4gICAgZG9uZUxpc3QucHJlcGVuZChub2RlKTtcclxuICAgIGQucmVtb3ZlKCk7XHJcbiAgfVxyXG4gIHNhdmVMb2NhbCgpO1xyXG59XHJcblxyXG5cclxuIl19
